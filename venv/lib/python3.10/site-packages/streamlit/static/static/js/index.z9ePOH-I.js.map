{"version":3,"file":"index.z9ePOH-I.js","sources":["../../../../lib/src/components/widgets/DownloadButton/DownloadButton.tsx"],"sourcesContent":["/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ReactElement } from \"react\"\n\nimport createDownloadLinkElement from \"@streamlit/lib/src/util/createDownloadLinkElement\"\nimport { DownloadButton as DownloadButtonProto } from \"@streamlit/lib/src/proto\"\nimport BaseButton, {\n  BaseButtonKind,\n  BaseButtonSize,\n  BaseButtonTooltip,\n  DynamicButtonLabel,\n} from \"@streamlit/lib/src/components/shared/BaseButton\"\nimport { WidgetStateManager } from \"@streamlit/lib/src/WidgetStateManager\"\nimport { StreamlitEndpoints } from \"@streamlit/lib/src/StreamlitEndpoints\"\nimport { LibContext } from \"@streamlit/lib/src/components/core/LibContext\"\n\nexport interface Props {\n  endpoints: StreamlitEndpoints\n  disabled: boolean\n  element: DownloadButtonProto\n  widgetMgr: WidgetStateManager\n  width: number\n  fragmentId?: string\n}\n\nexport function createDownloadLink(\n  endpoints: StreamlitEndpoints,\n  url: string,\n  enforceDownloadInNewTab: boolean\n): HTMLAnchorElement {\n  return createDownloadLinkElement({\n    enforceDownloadInNewTab,\n    url: endpoints.buildMediaURL(url),\n    filename: \"\",\n  })\n}\n\nfunction DownloadButton(props: Props): ReactElement {\n  const { disabled, element, widgetMgr, width, endpoints, fragmentId } = props\n  const style = { width }\n  const {\n    libConfig: { enforceDownloadInNewTab = false }, // Default to false, if no libConfig, e.g. for tests\n  } = React.useContext(LibContext)\n\n  let kind = BaseButtonKind.SECONDARY\n  if (element.type === \"primary\") {\n    kind = BaseButtonKind.PRIMARY\n  } else if (element.type === \"tertiary\") {\n    kind = BaseButtonKind.TERTIARY\n  }\n\n  const handleDownloadClick: () => void = () => {\n    // Downloads are only done on links, so create a hidden one and click it\n    // for the user.\n    widgetMgr.setTriggerValue(element, { fromUi: true }, fragmentId)\n    const link = createDownloadLink(\n      endpoints,\n      element.url,\n      enforceDownloadInNewTab\n    )\n    link.click()\n  }\n\n  // When useContainerWidth true & has help tooltip,\n  // we need to pass the container width down to the button\n  const fluidWidth = element.help ? width : true\n\n  return (\n    <div\n      className=\"stDownloadButton\"\n      data-testid=\"stDownloadButton\"\n      style={style}\n    >\n      <BaseButtonTooltip help={element.help}>\n        <BaseButton\n          kind={kind}\n          size={BaseButtonSize.SMALL}\n          disabled={disabled}\n          onClick={handleDownloadClick}\n          fluidWidth={element.useContainerWidth ? fluidWidth : false}\n        >\n          <DynamicButtonLabel icon={element.icon} label={element.label} />\n        </BaseButton>\n      </BaseButtonTooltip>\n    </div>\n  )\n}\n\nexport default DownloadButton\n"],"names":["createDownloadLink","endpoints","url","enforceDownloadInNewTab","createDownloadLinkElement","buildMediaURL","filename","DownloadButton","props","disabled","element","widgetMgr","width","fragmentId","style","libConfig","React","useContext","LibContext","kind","BaseButtonKind","SECONDARY","type","PRIMARY","TERTIARY","handleDownloadClick","setTriggerValue","fromUi","click","fluidWidth","help","div","className","data-testid","BaseButtonTooltip","BaseButton","size","BaseButtonSize","SMALL","onClick","useContainerWidth","DynamicButtonLabel","icon","label"],"mappings":"2JAuCgBA,SAAAA,EACdC,EACAC,EACAC,EAAgC,CAEhC,OAAOC,EAA0B,CAC/BD,wBAAAA,EACAD,IAAKD,EAAUI,cAAcH,CAAAA,EAC7BI,SAAU,EAAA,CACZ,CACF,CAEA,SAASC,EAAeC,EAAY,CAClC,KAAM,CAAEC,SAAAA,EAAUC,QAAAA,EAASC,UAAAA,EAAWC,MAAAA,EAAOX,UAAAA,EAAWY,WAAAA,CAAeL,EAAAA,EACjEM,EAAQ,CAAEF,MAAAA,CAAAA,EACV,CACJG,UAAW,CAAEZ,wBAAAA,EAA0B,EACxC,CAAA,EAAGa,EAAMC,WAAWC,CAAAA,EAErB,IAAIC,EAAOC,EAAeC,UACtBX,EAAQY,OAAS,UACnBH,EAAOC,EAAeG,QACbb,EAAQY,OAAS,aAC1BH,EAAOC,EAAeI,UAGxB,MAAMC,EAAkC,IAAA,CAGtCd,EAAUe,gBAAgBhB,EAAS,CAAEiB,OAAQ,IAAQd,CAAAA,EACxCb,EACXC,EACAS,EAAQR,IACRC,CAAAA,EAEGyB,MAAK,CAAA,EAKNC,EAAanB,EAAQoB,KAAOlB,EAAQ,GAE1C,SACGmB,MAAAA,CACCC,UAAU,mBACVC,cAAY,mBACZnB,MAAAA,EAEA,WAACoB,EAAAA,CAAkBJ,KAAMpB,EAAQoB,KAC/B,WAACK,EAAAA,CACChB,KAAAA,EACAiB,KAAMC,EAAeC,MACrB7B,SAAAA,EACA8B,QAASd,EACTI,WAAYnB,EAAQ8B,kBAAoBX,EAAa,GAErD,WAACY,EAAAA,CAAmBC,KAAMhC,EAAQgC,KAAMC,MAAOjC,EAAQiC,KAAAA,QAKjE"}