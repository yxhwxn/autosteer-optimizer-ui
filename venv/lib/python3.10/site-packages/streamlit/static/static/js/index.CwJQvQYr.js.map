{"version":3,"file":"index.CwJQvQYr.js","sources":["../../../../node_modules/@emotion-icons/open-iconic/Video/Video.esm.js","../../../../node_modules/@emotion-icons/open-iconic/X/X.esm.js","../../../../node_modules/@emotion-icons/material-rounded/SwitchCamera/SwitchCamera.esm.js","../../../../lib/src/components/widgets/CameraInput/styled-components.ts","../../../../lib/src/components/widgets/CameraInput/CameraInputButton.tsx","../../../../lib/src/components/widgets/CameraInput/SwitchFacingModeButton.tsx","../../../../node_modules/react-webcam/dist/react-webcam.js","../../../../lib/src/components/widgets/CameraInput/WebcamComponent.tsx","../../../../lib/src/components/widgets/CameraInput/CameraInput.tsx"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { EmotionIconBase } from '@emotion-icons/emotion-icon';\nexport var Video = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(EmotionIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 8 8\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M.5 1c-.28 0-.5.23-.5.5v4c0 .28.23.5.5.5h5c.28 0 .5-.22.5-.5V4l1 1h1V2H7L6 3V1.5c0-.28-.22-.5-.5-.5h-5z\"\n  }));\n});\nVideo.displayName = 'Video';\nexport var VideoDimensions = {\n  height: 8,\n  width: 8\n};","import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { EmotionIconBase } from '@emotion-icons/emotion-icon';\nexport var X = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(EmotionIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 8 8\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.41 0L0 1.41l.72.72L2.5 3.94.72 5.72 0 6.41l1.41 1.44.72-.72 1.81-1.81 1.78 1.81.69.72 1.44-1.44-.72-.69-1.81-1.78 1.81-1.81.72-.72L6.41 0l-.69.72L3.94 2.5 2.13.72 1.41 0z\"\n  }));\n});\nX.displayName = 'X';\nexport var XDimensions = {\n  height: 8,\n  width: 8\n};","import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { EmotionIconBase } from '@emotion-icons/emotion-icon';\nexport var SwitchCamera = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(EmotionIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 24 24\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"rect\", {\n    width: 24,\n    height: 24,\n    fill: \"none\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M20 5h-3.17l-1.24-1.35A1.99 1.99 0 0014.12 3H9.88c-.56 0-1.1.24-1.48.65L7.17 5H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-1.35 8.35l-2.79 2.79c-.32.32-.86.1-.86-.35v-1.75H9v1.75c0 .45-.54.67-.85.35l-2.79-2.79c-.2-.2-.2-.51 0-.71l2.79-2.79a.5.5 0 01.85.36v1.83h6v-1.83c0-.45.54-.67.85-.35l2.79 2.79c.2.19.2.51.01.7z\"\n  }));\n});\nSwitchCamera.displayName = 'SwitchCamera';\nexport var SwitchCameraDimensions = {\n  height: 24,\n  width: 24\n};","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { MouseEvent, ReactNode } from \"react\"\n\nimport styled, { CSSObject } from \"@emotion/styled\"\nimport { transparentize } from \"color2k\"\n\nimport { EmotionTheme } from \"@streamlit/lib/src/theme\"\n\nexport interface CameraInputButtonProps {\n  onClick?: (event: MouseEvent<HTMLButtonElement>) => any\n  disabled?: boolean\n  children: ReactNode\n  progress?: number | null\n}\n\nenum Size {\n  XSMALL = \"xsmall\",\n  SMALL = \"small\",\n  MEDIUM = \"medium\",\n  LARGE = \"large\",\n}\n\nfunction getSizeStyle(size: Size, theme: EmotionTheme): CSSObject {\n  switch (size) {\n    case Size.XSMALL:\n      return {\n        padding: `${theme.spacing.twoXS} ${theme.spacing.sm}`,\n        fontSize: theme.fontSizes.sm,\n      }\n    case Size.SMALL:\n      return {\n        padding: `${theme.spacing.twoXS} ${theme.spacing.md}`,\n      }\n    case Size.LARGE:\n      return {\n        padding: `${theme.spacing.md} ${theme.spacing.md}`,\n      }\n    default:\n      return {\n        padding: `${theme.spacing.xs} ${theme.spacing.md}`,\n      }\n  }\n}\n\ntype RequiredCameraInputButtonProps = Required<CameraInputButtonProps>\n\nexport const StyledCameraInput = styled.div({\n  // This is used to position the \"Switch facing mode\" button\n  // with respect to the webcam block.\n  position: \"relative\",\n  overflow: \"hidden\",\n  width: \"100%\",\n  objectFit: \"contain\",\n})\n\nexport interface StyledBoxProps {\n  width: number\n}\n\nexport const StyledBox = styled.div<StyledBoxProps>(({ theme, width }) => ({\n  backgroundColor: theme.colors.secondaryBg,\n  borderRadius: `${theme.radii.default} ${theme.radii.default} 0 0`,\n  width: \"100%\",\n  height: (width * 9) / 16,\n  display: \"flex\",\n  flexDirection: \"column\",\n  justifyContent: \"center\",\n  alignItems: \"center\",\n}))\n\nexport const StyledDescription = styled.p(({ theme }) => ({\n  marginTop: theme.spacing.sm,\n  textAlign: \"center\",\n}))\n\nexport interface StyledImgProps {\n  opacity: string\n}\n\nexport const StyledImg = styled.img<StyledImgProps>(({ theme, opacity }) => ({\n  borderRadius: `${theme.radii.default} ${theme.radii.default} 0 0`,\n  objectFit: \"contain\",\n  opacity,\n}))\n\nexport const StyledLink = styled.a(({ theme }) => ({\n  color: theme.colors.primary,\n  display: \"block\",\n  textDecoration: \"none\",\n}))\n\nexport const StyledSpan = styled.span({\n  display: \"flex\",\n  alignItems: \"center\",\n})\n\nexport const StyledSwitchFacingModeButton = styled.div(({ theme }) => ({\n  position: \"absolute\",\n  top: theme.spacing.lg,\n  right: theme.spacing.lg,\n  zIndex: theme.zIndices.priority,\n  color: theme.colors.fadedText40,\n  mixBlendMode: \"difference\",\n  opacity: 0.6,\n}))\n\nexport const StyledWebcamWrapper = styled.div({\n  display: \"flex\",\n})\n\nexport const StyledProgressBar = styled.div({\n  height: \"fit-content\",\n  width: \"100%\",\n  position: \"absolute\",\n  bottom: 0,\n})\n\nexport const StyledCameraInputBaseButton =\n  styled.button<RequiredCameraInputButtonProps>(({ theme }) => ({\n    position: \"relative\",\n    display: \"inline-flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    backgroundColor: theme.colors.lightenedBg05,\n    border: `${theme.sizes.borderWidth} solid ${theme.colors.borderColor}`,\n    borderRadius: `0 0 ${theme.radii.default} ${theme.radii.default}`,\n    \"&:hover\": {\n      borderColor: theme.colors.primary,\n      color: theme.colors.primary,\n    },\n    \"&:active\": {\n      color: theme.colors.white,\n      borderColor: theme.colors.primary,\n      backgroundColor: theme.colors.primary,\n    },\n    \"&:focus:not(:active)\": {\n      borderColor: theme.colors.primary,\n      color: theme.colors.primary,\n    },\n    \"&:disabled, &:disabled:hover, &:disabled:active\": {\n      color: theme.colors.fadedText40,\n    },\n    fontWeight: theme.fontWeights.normal,\n    padding: `${theme.spacing.xs} ${theme.spacing.md}`,\n    margin: theme.spacing.none,\n    lineHeight: theme.lineHeights.base,\n    color: \"inherit\",\n    width: \"100%\",\n    userSelect: \"none\",\n    \"&:focus\": {\n      outline: \"none\",\n    },\n    \"&:focus-visible\": {\n      boxShadow: `0 0 0 0.2rem ${transparentize(theme.colors.primary, 0.5)}`,\n    },\n    ...getSizeStyle(Size.MEDIUM, theme),\n  }))\n","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { MouseEvent, ReactElement, ReactNode } from \"react\"\n\nimport ProgressBar, {\n  Size as ProgressBarSize,\n} from \"@streamlit/lib/src/components/shared/ProgressBar\"\n\nimport {\n  StyledCameraInputBaseButton,\n  StyledProgressBar,\n} from \"./styled-components\"\n\nexport interface CameraInputButtonProps {\n  onClick?: (event: MouseEvent<HTMLButtonElement>) => any\n  disabled?: boolean\n  progress?: number | null\n  children?: ReactNode\n}\n\nfunction CameraInputButton({\n  disabled,\n  onClick,\n  children,\n  progress,\n}: CameraInputButtonProps): ReactElement {\n  return (\n    <StyledCameraInputBaseButton\n      disabled={disabled || false}\n      onClick={onClick || (() => {})}\n      progress={progress || null}\n      data-testid=\"stCameraInputButton\"\n    >\n      {children}\n      {progress && (\n        <StyledProgressBar>\n          <ProgressBar\n            value={progress}\n            size={ProgressBarSize.EXTRASMALL}\n            overrides={{\n              Bar: {\n                style: {\n                  borderTopLeftRadius: 0,\n                  borderTopRightRadius: 0,\n                },\n              },\n              BarProgress: {\n                style: {\n                  borderTopLeftRadius: 0,\n                  borderTopRightRadius: 0,\n                },\n              },\n              BarContainer: {\n                style: {\n                  borderTopLeftRadius: 0,\n                  borderTopRightRadius: 0,\n                },\n              },\n            }}\n          />\n        </StyledProgressBar>\n      )}\n    </StyledCameraInputBaseButton>\n  )\n}\n\nexport default CameraInputButton\n","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ReactElement } from \"react\"\n\nimport { SwitchCamera } from \"@emotion-icons/material-rounded\"\n\nimport BaseButton, {\n  BaseButtonKind,\n} from \"@streamlit/lib/src/components/shared/BaseButton\"\nimport Icon from \"@streamlit/lib/src/components/shared/Icon\"\nimport Tooltip, {\n  Placement,\n} from \"@streamlit/lib/src/components/shared/Tooltip\"\nimport themeColors from \"@streamlit/lib/src/theme/emotionBaseTheme/themeColors\"\n\nimport { StyledSwitchFacingModeButton } from \"./styled-components\"\n\nexport enum FacingMode {\n  USER = \"user\",\n  ENVIRONMENT = \"environment\",\n}\n\nexport interface SwitchFacingModeButtonProps {\n  switchFacingMode: () => void\n}\n\nconst SwitchFacingModeButton = ({\n  switchFacingMode,\n}: SwitchFacingModeButtonProps): ReactElement => {\n  return (\n    <StyledSwitchFacingModeButton data-testid=\"stCameraInputSwitchButton\">\n      <Tooltip content=\"Switch camera\" placement={Placement.TOP_RIGHT}>\n        <BaseButton kind={BaseButtonKind.MINIMAL} onClick={switchFacingMode}>\n          <Icon\n            content={SwitchCamera}\n            size=\"twoXL\"\n            color={themeColors.white}\n          />\n        </BaseButton>\n      </Tooltip>\n    </StyledSwitchFacingModeButton>\n  )\n}\n\nexport default SwitchFacingModeButton\n","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Webcam\"] = factory(require(\"react\"));\n\telse\n\t\troot[\"Webcam\"] = factory(root[\"React\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_react__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = \"./src/react-webcam.tsx\");\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ \"./src/react-webcam.tsx\":\n/*!******************************!*\\\n  !*** ./src/react-webcam.tsx ***!\n  \\******************************/\n/*! exports provided: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (undefined && undefined.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\n\n// polyfill based on https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n(function polyfillGetUserMedia() {\n    if (typeof window === 'undefined') {\n        return;\n    }\n    // Older browsers might not implement mediaDevices at all, so we set an empty object first\n    if (navigator.mediaDevices === undefined) {\n        navigator.mediaDevices = {};\n    }\n    // Some browsers partially implement mediaDevices. We can't just assign an object\n    // with getUserMedia as it would overwrite existing properties.\n    // Here, we will just add the getUserMedia property if it's missing.\n    if (navigator.mediaDevices.getUserMedia === undefined) {\n        navigator.mediaDevices.getUserMedia = function (constraints) {\n            // First get ahold of the legacy getUserMedia, if present\n            var getUserMedia = navigator.getUserMedia ||\n                navigator.webkitGetUserMedia ||\n                navigator.mozGetUserMedia ||\n                navigator.msGetUserMedia;\n            // Some browsers just don't implement it - return a rejected promise with an error\n            // to keep a consistent interface\n            if (!getUserMedia) {\n                return Promise.reject(new Error(\"getUserMedia is not implemented in this browser\"));\n            }\n            // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n            return new Promise(function (resolve, reject) {\n                getUserMedia.call(navigator, constraints, resolve, reject);\n            });\n        };\n    }\n})();\nfunction hasGetUserMedia() {\n    return !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia);\n}\nvar Webcam = /** @class */ (function (_super) {\n    __extends(Webcam, _super);\n    function Webcam(props) {\n        var _this = _super.call(this, props) || this;\n        _this.canvas = null;\n        _this.ctx = null;\n        _this.requestUserMediaId = 0;\n        _this.unmounted = false;\n        _this.state = {\n            hasUserMedia: false\n        };\n        return _this;\n    }\n    Webcam.prototype.componentDidMount = function () {\n        var _a = this, state = _a.state, props = _a.props;\n        this.unmounted = false;\n        if (!hasGetUserMedia()) {\n            props.onUserMediaError(\"getUserMedia not supported\");\n            return;\n        }\n        if (!state.hasUserMedia) {\n            this.requestUserMedia();\n        }\n        if (props.children && typeof props.children != 'function') {\n            console.warn(\"children must be a function\");\n        }\n    };\n    Webcam.prototype.componentDidUpdate = function (nextProps) {\n        var props = this.props;\n        if (!hasGetUserMedia()) {\n            props.onUserMediaError(\"getUserMedia not supported\");\n            return;\n        }\n        var audioConstraintsChanged = JSON.stringify(nextProps.audioConstraints) !==\n            JSON.stringify(props.audioConstraints);\n        var videoConstraintsChanged = JSON.stringify(nextProps.videoConstraints) !==\n            JSON.stringify(props.videoConstraints);\n        var minScreenshotWidthChanged = nextProps.minScreenshotWidth !== props.minScreenshotWidth;\n        var minScreenshotHeightChanged = nextProps.minScreenshotHeight !== props.minScreenshotHeight;\n        if (videoConstraintsChanged ||\n            minScreenshotWidthChanged ||\n            minScreenshotHeightChanged) {\n            this.canvas = null;\n            this.ctx = null;\n        }\n        if (audioConstraintsChanged || videoConstraintsChanged) {\n            this.stopAndCleanup();\n            this.requestUserMedia();\n        }\n    };\n    Webcam.prototype.componentWillUnmount = function () {\n        this.unmounted = true;\n        this.stopAndCleanup();\n    };\n    Webcam.stopMediaStream = function (stream) {\n        if (stream) {\n            if (stream.getVideoTracks && stream.getAudioTracks) {\n                stream.getVideoTracks().map(function (track) {\n                    stream.removeTrack(track);\n                    track.stop();\n                });\n                stream.getAudioTracks().map(function (track) {\n                    stream.removeTrack(track);\n                    track.stop();\n                });\n            }\n            else {\n                stream.stop();\n            }\n        }\n    };\n    Webcam.prototype.stopAndCleanup = function () {\n        var state = this.state;\n        if (state.hasUserMedia) {\n            Webcam.stopMediaStream(this.stream);\n            if (state.src) {\n                window.URL.revokeObjectURL(state.src);\n            }\n        }\n    };\n    Webcam.prototype.getScreenshot = function (screenshotDimensions) {\n        var _a = this, state = _a.state, props = _a.props;\n        if (!state.hasUserMedia)\n            return null;\n        var canvas = this.getCanvas(screenshotDimensions);\n        return (canvas &&\n            canvas.toDataURL(props.screenshotFormat, props.screenshotQuality));\n    };\n    Webcam.prototype.getCanvas = function (screenshotDimensions) {\n        var _a = this, state = _a.state, props = _a.props;\n        if (!this.video) {\n            return null;\n        }\n        if (!state.hasUserMedia || !this.video.videoHeight)\n            return null;\n        if (!this.ctx) {\n            var canvasWidth = this.video.videoWidth;\n            var canvasHeight = this.video.videoHeight;\n            if (!this.props.forceScreenshotSourceSize) {\n                var aspectRatio = canvasWidth / canvasHeight;\n                canvasWidth = props.minScreenshotWidth || this.video.clientWidth;\n                canvasHeight = canvasWidth / aspectRatio;\n                if (props.minScreenshotHeight &&\n                    canvasHeight < props.minScreenshotHeight) {\n                    canvasHeight = props.minScreenshotHeight;\n                    canvasWidth = canvasHeight * aspectRatio;\n                }\n            }\n            this.canvas = document.createElement(\"canvas\");\n            this.canvas.width = (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.width) || canvasWidth;\n            this.canvas.height = (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.height) || canvasHeight;\n            this.ctx = this.canvas.getContext(\"2d\");\n        }\n        var _b = this, ctx = _b.ctx, canvas = _b.canvas;\n        if (ctx && canvas) {\n            // adjust the height and width of the canvas to the given dimensions\n            canvas.width = (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.width) || canvas.width;\n            canvas.height = (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.height) || canvas.height;\n            // mirror the screenshot\n            if (props.mirrored) {\n                ctx.translate(canvas.width, 0);\n                ctx.scale(-1, 1);\n            }\n            ctx.imageSmoothingEnabled = props.imageSmoothing;\n            ctx.drawImage(this.video, 0, 0, (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.width) || canvas.width, (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.height) || canvas.height);\n            // invert mirroring\n            if (props.mirrored) {\n                ctx.scale(-1, 1);\n                ctx.translate(-canvas.width, 0);\n            }\n        }\n        return canvas;\n    };\n    Webcam.prototype.requestUserMedia = function () {\n        var _this = this;\n        var props = this.props;\n        var sourceSelected = function (audioConstraints, videoConstraints) {\n            var constraints = {\n                video: typeof videoConstraints !== \"undefined\" ? videoConstraints : true\n            };\n            if (props.audio) {\n                constraints.audio =\n                    typeof audioConstraints !== \"undefined\" ? audioConstraints : true;\n            }\n            _this.requestUserMediaId++;\n            var myRequestUserMediaId = _this.requestUserMediaId;\n            navigator.mediaDevices\n                .getUserMedia(constraints)\n                .then(function (stream) {\n                if (_this.unmounted || myRequestUserMediaId !== _this.requestUserMediaId) {\n                    Webcam.stopMediaStream(stream);\n                }\n                else {\n                    _this.handleUserMedia(null, stream);\n                }\n            })\n                .catch(function (e) {\n                _this.handleUserMedia(e);\n            });\n        };\n        if (\"mediaDevices\" in navigator) {\n            sourceSelected(props.audioConstraints, props.videoConstraints);\n        }\n        else {\n            var optionalSource_1 = function (id) { return ({ optional: [{ sourceId: id }] }); };\n            var constraintToSourceId_1 = function (constraint) {\n                var deviceId = constraint.deviceId;\n                if (typeof deviceId === \"string\") {\n                    return deviceId;\n                }\n                if (Array.isArray(deviceId) && deviceId.length > 0) {\n                    return deviceId[0];\n                }\n                if (typeof deviceId === \"object\" && deviceId.ideal) {\n                    return deviceId.ideal;\n                }\n                return null;\n            };\n            // @ts-ignore: deprecated api\n            MediaStreamTrack.getSources(function (sources) {\n                var audioSource = null;\n                var videoSource = null;\n                sources.forEach(function (source) {\n                    if (source.kind === \"audio\") {\n                        audioSource = source.id;\n                    }\n                    else if (source.kind === \"video\") {\n                        videoSource = source.id;\n                    }\n                });\n                var audioSourceId = constraintToSourceId_1(props.audioConstraints);\n                if (audioSourceId) {\n                    audioSource = audioSourceId;\n                }\n                var videoSourceId = constraintToSourceId_1(props.videoConstraints);\n                if (videoSourceId) {\n                    videoSource = videoSourceId;\n                }\n                sourceSelected(optionalSource_1(audioSource), optionalSource_1(videoSource));\n            });\n        }\n    };\n    Webcam.prototype.handleUserMedia = function (err, stream) {\n        var props = this.props;\n        if (err || !stream) {\n            this.setState({ hasUserMedia: false });\n            props.onUserMediaError(err);\n            return;\n        }\n        this.stream = stream;\n        try {\n            if (this.video) {\n                this.video.srcObject = stream;\n            }\n            this.setState({ hasUserMedia: true });\n        }\n        catch (error) {\n            this.setState({\n                hasUserMedia: true,\n                src: window.URL.createObjectURL(stream)\n            });\n        }\n        props.onUserMedia(stream);\n    };\n    Webcam.prototype.render = function () {\n        var _this = this;\n        var _a = this, state = _a.state, props = _a.props;\n        var audio = props.audio, forceScreenshotSourceSize = props.forceScreenshotSourceSize, onUserMedia = props.onUserMedia, onUserMediaError = props.onUserMediaError, screenshotFormat = props.screenshotFormat, screenshotQuality = props.screenshotQuality, minScreenshotWidth = props.minScreenshotWidth, minScreenshotHeight = props.minScreenshotHeight, audioConstraints = props.audioConstraints, videoConstraints = props.videoConstraints, imageSmoothing = props.imageSmoothing, mirrored = props.mirrored, _b = props.style, style = _b === void 0 ? {} : _b, children = props.children, rest = __rest(props, [\"audio\", \"forceScreenshotSourceSize\", \"onUserMedia\", \"onUserMediaError\", \"screenshotFormat\", \"screenshotQuality\", \"minScreenshotWidth\", \"minScreenshotHeight\", \"audioConstraints\", \"videoConstraints\", \"imageSmoothing\", \"mirrored\", \"style\", \"children\"]);\n        var videoStyle = mirrored ? __assign(__assign({}, style), { transform: (style.transform || \"\") + \" scaleX(-1)\" }) : style;\n        var childrenProps = {\n            getScreenshot: this.getScreenshot.bind(this),\n        };\n        return (react__WEBPACK_IMPORTED_MODULE_0__[\"createElement\"](react__WEBPACK_IMPORTED_MODULE_0__[\"Fragment\"], null,\n            react__WEBPACK_IMPORTED_MODULE_0__[\"createElement\"](\"video\", __assign({ autoPlay: true, src: state.src, muted: !audio, playsInline: true, ref: function (ref) {\n                    _this.video = ref;\n                }, style: videoStyle }, rest)),\n            children && children(childrenProps)));\n    };\n    Webcam.defaultProps = {\n        audio: false,\n        forceScreenshotSourceSize: false,\n        imageSmoothing: true,\n        mirrored: false,\n        onUserMedia: function () { return undefined; },\n        onUserMediaError: function () { return undefined; },\n        screenshotFormat: \"image/webp\",\n        screenshotQuality: 0.92,\n    };\n    return Webcam;\n}(react__WEBPACK_IMPORTED_MODULE_0__[\"Component\"]));\n/* harmony default export */ __webpack_exports__[\"default\"] = (Webcam);\n\n\n/***/ }),\n\n/***/ \"react\":\n/*!**************************************************************************************!*\\\n  !*** external {\"root\":\"React\",\"commonjs2\":\"react\",\"commonjs\":\"react\",\"amd\":\"react\"} ***!\n  \\**************************************************************************************/\n/*! no static exports found */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_react__;\n\n/***/ })\n\n/******/ })[\"default\"];\n});\n//# sourceMappingURL=react-webcam.js.map","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  ReactElement,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\"\n\nimport { Video } from \"@emotion-icons/open-iconic\"\nimport { useTheme } from \"@emotion/react\"\nimport { isMobile } from \"react-device-detect\"\nimport Webcam from \"react-webcam\"\n\nimport { debounce } from \"@streamlit/lib/src/util/utils\"\nimport Icon from \"@streamlit/lib/src/components/shared/Icon\"\nimport { EmotionTheme } from \"@streamlit/lib/src/theme\"\nimport themeColors from \"@streamlit/lib/src/theme/emotionBaseTheme/themeColors\"\nimport { CAMERA_PERMISSION_URL } from \"@streamlit/lib/src/urls\"\n\nimport CameraInputButton from \"./CameraInputButton\"\nimport SwitchFacingModeButton, { FacingMode } from \"./SwitchFacingModeButton\"\nimport {\n  StyledBox,\n  StyledCameraInput,\n  StyledDescription,\n  StyledLink,\n} from \"./styled-components\"\n\nexport interface Props {\n  handleCapture: (capturedPhoto: string | null) => void\n  width: number\n  disabled: boolean\n  clearPhotoInProgress: boolean\n  setClearPhotoInProgress: (clearPhotoInProgress: boolean) => void\n  facingMode: FacingMode\n  setFacingMode: () => void\n  // Allow for unit testing\n  testOverride?: WebcamPermission\n}\n\nexport enum WebcamPermission {\n  PENDING = \"pending\",\n  SUCCESS = \"success\",\n  ERROR = \"error\",\n}\n\ninterface AskForCameraPermissionProps {\n  width: number\n}\n\nexport const AskForCameraPermission = ({\n  width,\n}: AskForCameraPermissionProps): ReactElement => {\n  return (\n    <StyledBox width={width}>\n      <Icon size=\"threeXL\" color={themeColors.gray60} content={Video} />\n      <StyledDescription>\n        This app would like to use your camera.\n        <StyledLink\n          href={CAMERA_PERMISSION_URL}\n          rel=\"noopener noreferrer\"\n          target=\"_blank\"\n        >\n          Learn how to allow access.\n        </StyledLink>\n      </StyledDescription>\n    </StyledBox>\n  )\n}\n\nconst WebcamComponent = ({\n  handleCapture,\n  width,\n  disabled,\n  clearPhotoInProgress,\n  setClearPhotoInProgress,\n  facingMode,\n  setFacingMode,\n  testOverride,\n}: Props): ReactElement => {\n  const [webcamPermission, setWebcamPermissionState] = useState(\n    testOverride || WebcamPermission.PENDING\n  )\n  const videoRef = useRef<Webcam>(null)\n\n  const [debouncedWidth, setDebouncedWidth] = useState(width)\n\n  // TODO: Update to match React best practices\n  // eslint-disable-next-line react-compiler/react-compiler\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const memoizedSetDebouncedCallback = useCallback(\n    debounce(1000, setDebouncedWidth),\n    []\n  )\n\n  useEffect(() => {\n    memoizedSetDebouncedCallback(width)\n  }, [width, memoizedSetDebouncedCallback])\n\n  function capture(): void {\n    if (videoRef.current !== null) {\n      const imageSrc = videoRef.current.getScreenshot()\n      handleCapture(imageSrc)\n    }\n  }\n\n  const theme: EmotionTheme = useTheme()\n\n  return (\n    <StyledCameraInput data-testid=\"stCameraInputWebcamComponent\">\n      {webcamPermission !== WebcamPermission.SUCCESS &&\n      !disabled &&\n      !clearPhotoInProgress ? (\n        <AskForCameraPermission width={debouncedWidth} />\n      ) : (\n        isMobile && <SwitchFacingModeButton switchFacingMode={setFacingMode} />\n      )}\n      <StyledBox\n        data-testid=\"stCameraInputWebcamStyledBox\"\n        hidden={\n          webcamPermission !== WebcamPermission.SUCCESS &&\n          !disabled &&\n          !clearPhotoInProgress\n        }\n        width={debouncedWidth}\n      >\n        {!disabled && (\n          <Webcam\n            audio={false}\n            ref={videoRef}\n            screenshotFormat=\"image/jpeg\"\n            screenshotQuality={1}\n            width={debouncedWidth}\n            // We keep Aspect ratio of container always equal 16 / 9.\n            // The aspect ration of video stream may be different depending on a camera.\n            height={(debouncedWidth * 9) / 16}\n            style={{\n              borderRadius: `${theme.radii.default} ${theme.radii.default} 0 0`,\n            }}\n            onUserMediaError={() => {\n              setWebcamPermissionState(WebcamPermission.ERROR)\n            }}\n            onUserMedia={() => {\n              setWebcamPermissionState(WebcamPermission.SUCCESS)\n              setClearPhotoInProgress(false)\n            }}\n            videoConstraints={{\n              width: { ideal: debouncedWidth },\n              facingMode,\n            }}\n          />\n        )}\n      </StyledBox>\n      <CameraInputButton\n        onClick={capture}\n        disabled={\n          webcamPermission !== WebcamPermission.SUCCESS ||\n          disabled ||\n          clearPhotoInProgress\n        }\n      >\n        Take Photo\n      </CameraInputButton>\n    </StyledCameraInput>\n  )\n}\n\nexport default WebcamComponent\n","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from \"react\"\n\nimport { X } from \"@emotion-icons/open-iconic\"\nimport axios from \"axios\"\nimport isEqual from \"lodash/isEqual\"\n\nimport {\n  CameraInput as CameraInputProto,\n  FileUploaderState as FileUploaderStateProto,\n  FileURLs as FileURLsProto,\n  IFileURLs,\n  UploadedFileInfo as UploadedFileInfoProto,\n} from \"@streamlit/lib/src/proto\"\nimport Icon from \"@streamlit/lib/src/components/shared/Icon\"\nimport { Placement } from \"@streamlit/lib/src/components/shared/Tooltip\"\nimport TooltipIcon from \"@streamlit/lib/src/components/shared/TooltipIcon\"\nimport {\n  StyledWidgetLabelHelp,\n  WidgetLabel,\n} from \"@streamlit/lib/src/components/widgets/BaseWidget\"\nimport { FormClearHelper } from \"@streamlit/lib/src/components/widgets/Form\"\nimport { FileUploadClient } from \"@streamlit/lib/src/FileUploadClient\"\nimport { logError } from \"@streamlit/lib/src/util/log\"\nimport { WidgetStateManager } from \"@streamlit/lib/src/WidgetStateManager\"\nimport {\n  isNullOrUndefined,\n  labelVisibilityProtoValueToEnum,\n} from \"@streamlit/lib/src/util/utils\"\nimport {\n  UploadedStatus,\n  UploadFileInfo,\n  UploadingStatus,\n} from \"@streamlit/lib/src/components/widgets/FileUploader/UploadFileInfo\"\n\nimport CameraInputButton from \"./CameraInputButton\"\nimport { FacingMode } from \"./SwitchFacingModeButton\"\nimport {\n  StyledBox,\n  StyledCameraInput,\n  StyledImg,\n  StyledSpan,\n} from \"./styled-components\"\nimport WebcamComponent, { WebcamPermission } from \"./WebcamComponent\"\n\nexport interface Props {\n  element: CameraInputProto\n  widgetMgr: WidgetStateManager\n  uploadClient: FileUploadClient\n  disabled: boolean\n  width: number\n  fragmentId?: string\n  // Allow for unit testing\n  testOverride?: WebcamPermission\n}\n\ntype FileUploaderStatus =\n  | \"ready\" // FileUploader can upload or delete files\n  | \"updating\" // at least one file is being uploaded or deleted\n\nexport interface State {\n  /**\n   * Base64-encoded image data of the current frame from the camera.\n   */\n  imgSrc: string | null\n\n  shutter: boolean\n\n  minShutterEffectPassed: boolean\n  /**\n   * List of files (snapshots) captured by the user.\n   * Should contain exact one element if the user has taken a snapshot.\n   */\n  files: UploadFileInfo[]\n\n  /**\n   * Represents whether the component is in clear photo mode,\n   * when snapshot removed and new Webcam component is not shown yet.\n   * Time interval between `Clear Photo` button clicked and access to Webcam received again\n   */\n  clearPhotoInProgress: boolean\n\n  /**\n   * User facing mode for mobile devices. If `user`, the camera will be facing the user (front camera).\n   * If `environment`, the camera will be facing the environment (back camera).\n   */\n  facingMode: FacingMode\n}\n\nconst MIN_SHUTTER_EFFECT_TIME_MS = 150\n\nclass CameraInput extends React.PureComponent<Props, State> {\n  private localFileIdCounter = 1\n\n  private RESTORED_FROM_WIDGET_STRING = \"RESTORED_FROM_WIDGET\"\n\n  private readonly formClearHelper = new FormClearHelper()\n\n  public constructor(props: Props) {\n    super(props)\n    this.state = this.initialValue\n  }\n\n  private getProgress = (): number | null | undefined => {\n    if (\n      this.state.files.length > 0 &&\n      this.state.files[this.state.files.length - 1].status.type === \"uploading\"\n    ) {\n      const status = this.state.files[this.state.files.length - 1]\n        .status as UploadingStatus\n      return status.progress\n    }\n    return undefined\n  }\n\n  private setClearPhotoInProgress = (clearPhotoInProgress: boolean): void => {\n    this.setState({ clearPhotoInProgress })\n  }\n\n  private setFacingMode = (): void => {\n    this.setState(prevState => ({\n      facingMode:\n        prevState.facingMode === FacingMode.USER\n          ? FacingMode.ENVIRONMENT\n          : FacingMode.USER,\n    }))\n  }\n\n  private handleCapture = (imgSrc: string | null): Promise<void> => {\n    if (imgSrc === null) {\n      return Promise.resolve()\n    }\n\n    this.setState({\n      imgSrc,\n      shutter: true,\n      minShutterEffectPassed: false,\n    })\n\n    const delay = (t: number): Promise<ReturnType<typeof setTimeout>> =>\n      new Promise(resolve => setTimeout(resolve, t))\n\n    return urltoFile(\n      imgSrc,\n      `camera-input-${new Date().toISOString().replace(/:/g, \"_\")}.jpg`\n    )\n      .then(file =>\n        this.props.uploadClient\n          .fetchFileURLs([file])\n          .then(fileURLsArray => ({ file: file, fileUrls: fileURLsArray[0] }))\n      )\n      .then(({ file, fileUrls }) => this.uploadFile(fileUrls, file))\n      .then(() => delay(MIN_SHUTTER_EFFECT_TIME_MS))\n      .then(() => {\n        this.setState((prevState, _) => {\n          return {\n            imgSrc,\n            shutter: prevState.shutter,\n            minShutterEffectPassed: true,\n          }\n        })\n      })\n      .catch(err => {\n        logError(err)\n      })\n  }\n\n  private removeCapture = (): void => {\n    if (this.state.files.length === 0) {\n      return\n    }\n\n    this.state.files.forEach(file => this.deleteFile(file.id))\n\n    this.setState({\n      imgSrc: null,\n      clearPhotoInProgress: true,\n    })\n  }\n\n  get initialValue(): State {\n    const emptyState = {\n      files: [],\n      imgSrc: null,\n      shutter: false,\n      minShutterEffectPassed: true,\n      clearPhotoInProgress: false,\n      facingMode: FacingMode.USER,\n    }\n    const { widgetMgr, element } = this.props\n\n    const widgetValue = widgetMgr.getFileUploaderStateValue(element)\n\n    if (isNullOrUndefined(widgetValue)) {\n      return emptyState\n    }\n\n    const { uploadedFileInfo } = widgetValue\n    if (isNullOrUndefined(uploadedFileInfo) || uploadedFileInfo.length === 0) {\n      return emptyState\n    }\n\n    return {\n      files: uploadedFileInfo.map(f => {\n        const name = f.name as string\n        const size = f.size as number\n\n        const fileId = f.fileId as string\n        const fileUrls = f.fileUrls as FileURLsProto\n\n        return new UploadFileInfo(name, size, this.nextLocalFileId(), {\n          type: \"uploaded\",\n          fileId,\n          fileUrls,\n        })\n      }),\n      imgSrc:\n        uploadedFileInfo.length === 0 ? \"\" : this.RESTORED_FROM_WIDGET_STRING,\n      shutter: false,\n      minShutterEffectPassed: false,\n      clearPhotoInProgress: false,\n      facingMode: FacingMode.USER,\n    }\n  }\n\n  public componentWillUnmount(): void {\n    this.formClearHelper.disconnect()\n  }\n\n  /**\n   * Return the FileUploader's current status, which is derived from\n   * its state.\n   */\n  public get status(): FileUploaderStatus {\n    const isFileUpdating = (file: UploadFileInfo): boolean =>\n      file.status.type === \"uploading\"\n\n    // If any of our files is Uploading or Deleting, then we're currently\n    // updating.\n    if (this.state.files.some(isFileUpdating)) {\n      return \"updating\"\n    }\n\n    return \"ready\"\n  }\n\n  public componentDidUpdate = (): void => {\n    // If our status is not \"ready\", then we have uploads in progress.\n    // We won't submit a new widgetValue until all uploads have resolved.\n    if (this.status !== \"ready\") {\n      return\n    }\n\n    // If we have had no completed uploads, our widgetValue will be\n    // undefined, and we can early-out of the state update.\n    const newWidgetValue = this.createWidgetValue()\n\n    const { element, widgetMgr, fragmentId } = this.props\n\n    // Maybe send a widgetValue update to the widgetStateManager.\n    const prevWidgetValue = widgetMgr.getFileUploaderStateValue(element)\n    if (!isEqual(newWidgetValue, prevWidgetValue)) {\n      widgetMgr.setFileUploaderStateValue(\n        element,\n        newWidgetValue,\n        {\n          fromUi: true,\n        },\n        fragmentId\n      )\n    }\n  }\n\n  public componentDidMount(): void {\n    const newWidgetValue = this.createWidgetValue()\n    const { element, widgetMgr, fragmentId } = this.props\n\n    // Set the state value on mount, to avoid triggering an extra rerun after\n    // the first rerun.\n    // We use same primitives as in file uploader widget,\n    // since simanticly camera_input is just a special case of file uploader.\n    const prevWidgetValue = widgetMgr.getFileUploaderStateValue(element)\n    if (prevWidgetValue === undefined) {\n      widgetMgr.setFileUploaderStateValue(\n        element,\n        newWidgetValue,\n        {\n          fromUi: false,\n        },\n        fragmentId\n      )\n    }\n  }\n\n  private createWidgetValue(): FileUploaderStateProto {\n    const uploadedFileInfo: UploadedFileInfoProto[] = this.state.files\n      .filter(f => f.status.type === \"uploaded\")\n      .map(f => {\n        const { name, size, status } = f\n        return new UploadedFileInfoProto({\n          fileId: (status as UploadedStatus).fileId,\n          fileUrls: (status as UploadedStatus).fileUrls,\n          name,\n          size,\n        })\n      })\n\n    return new FileUploaderStateProto({ uploadedFileInfo })\n  }\n\n  /**\n   * If we're part of a clear_on_submit form, this will be called when our\n   * form is submitted. Restore our default value and update the WidgetManager.\n   */\n  private onFormCleared = (): void => {\n    this.setState({ files: [] }, () => {\n      const newWidgetValue = this.createWidgetValue()\n      if (isNullOrUndefined(newWidgetValue)) {\n        return\n      }\n\n      this.setState({\n        imgSrc: null,\n      })\n\n      const { widgetMgr, element, fragmentId } = this.props\n      widgetMgr.setFileUploaderStateValue(\n        element,\n        newWidgetValue,\n        { fromUi: true },\n        fragmentId\n      )\n    })\n  }\n\n  public render(): React.ReactNode {\n    const { element, widgetMgr, disabled, width } = this.props\n\n    // Manage our form-clear event handler.\n    this.formClearHelper.manageFormClearListener(\n      widgetMgr,\n      element.formId,\n      this.onFormCleared\n    )\n\n    return (\n      <StyledCameraInput className=\"stCameraInput\" data-testid=\"stCameraInput\">\n        <WidgetLabel\n          label={element.label}\n          disabled={disabled}\n          labelVisibility={labelVisibilityProtoValueToEnum(\n            element.labelVisibility?.value\n          )}\n        >\n          {element.help && (\n            <StyledWidgetLabelHelp>\n              <TooltipIcon\n                content={element.help}\n                placement={Placement.TOP_RIGHT}\n              />\n            </StyledWidgetLabelHelp>\n          )}\n        </WidgetLabel>\n        {this.state.imgSrc ? (\n          <>\n            <StyledBox width={width}>\n              {this.state.imgSrc !== this.RESTORED_FROM_WIDGET_STRING && (\n                <StyledImg\n                  src={this.state.imgSrc}\n                  alt=\"Snapshot\"\n                  opacity={\n                    this.state.shutter || !this.state.minShutterEffectPassed\n                      ? \"50%\"\n                      : \"100%\"\n                  }\n                  width={width}\n                  height={(width * 9) / 16}\n                />\n              )}\n            </StyledBox>\n            <CameraInputButton\n              onClick={this.removeCapture}\n              progress={this.getProgress()}\n              disabled={!!this.getProgress() || disabled}\n            >\n              {this.getProgress() ? (\n                \"Uploading...\"\n              ) : (\n                <StyledSpan>\n                  <Icon content={X} margin=\"0 xs 0 0\" size=\"sm\" /> Clear photo\n                </StyledSpan>\n              )}\n            </CameraInputButton>\n          </>\n        ) : (\n          <WebcamComponent\n            handleCapture={this.handleCapture}\n            width={width}\n            disabled={disabled}\n            clearPhotoInProgress={this.state.clearPhotoInProgress}\n            setClearPhotoInProgress={this.setClearPhotoInProgress}\n            facingMode={this.state.facingMode}\n            setFacingMode={this.setFacingMode}\n            testOverride={this.props.testOverride}\n          />\n        )}\n      </StyledCameraInput>\n    )\n  }\n\n  private nextLocalFileId(): number {\n    return this.localFileIdCounter++\n  }\n\n  /**\n   * Delete the file with the given ID:\n   * - Cancel the file upload if it's in progress\n   * - Remove the fileID from our local state\n   * We don't actually tell the server to delete the file. It will garbage\n   * collect it.\n   */\n  public deleteFile = (fileId: number): void => {\n    const file = this.getFile(fileId)\n    if (isNullOrUndefined(file)) {\n      return\n    }\n\n    if (file.status.type === \"uploading\") {\n      // The file hasn't been uploaded. Let's cancel the request.\n      // However, it may have been received by the server so we'll still\n      // send out a request to delete.\n      file.status.cancelToken.cancel()\n    }\n\n    if (file.status.type === \"uploaded\" && file.status.fileUrls.deleteUrl) {\n      this.props.uploadClient.deleteFile(file.status.fileUrls.deleteUrl)\n    }\n    this.removeFile(fileId)\n  }\n\n  /** Append the given file to `state.files`. */\n  private addFile = (file: UploadFileInfo): void => {\n    this.setState(state => ({ files: [...state.files, file] }))\n  }\n\n  /** Remove the file with the given ID from `state.files`. */\n  private removeFile = (idToRemove: number): void => {\n    this.setState(state => ({\n      files: state.files.filter(file => file.id !== idToRemove),\n    }))\n  }\n\n  /**\n   * Return the file with the given ID, if one exists.\n   */\n  private getFile = (fileId: number): UploadFileInfo | undefined => {\n    return this.state.files.find(file => file.id === fileId)\n  }\n\n  /** Replace the file with the given id in `state.files`. */\n  private updateFile = (curFileId: number, newFile: UploadFileInfo): void => {\n    this.setState(curState => {\n      return {\n        files: curState.files.map(file =>\n          file.id === curFileId ? newFile : file\n        ),\n      }\n    })\n  }\n\n  /**\n   * Called when an upload has completed. Updates the file's status, and\n   * assigns it the new file ID returned from the server.\n   */\n  private onUploadComplete = (\n    localFileId: number,\n    fileUrls: IFileURLs\n  ): void => {\n    this.setState(() => ({\n      shutter: false,\n    }))\n\n    const curFile = this.getFile(localFileId)\n    if (isNullOrUndefined(curFile) || curFile.status.type !== \"uploading\") {\n      // The file may have been canceled right before the upload\n      // completed. In this case, we just bail.\n      return\n    }\n\n    this.updateFile(\n      curFile.id,\n      curFile.setStatus({\n        type: \"uploaded\",\n        fileId: fileUrls.fileId as string,\n        fileUrls,\n      })\n    )\n  }\n\n  /**\n   * Callback for file upload progress. Updates a single file's local `progress`\n   * state.\n   */\n  private onUploadProgress = (event: ProgressEvent, fileId: number): void => {\n    const file = this.getFile(fileId)\n    if (isNullOrUndefined(file) || file.status.type !== \"uploading\") {\n      return\n    }\n\n    const newProgress = Math.round((event.loaded * 100) / event.total)\n    if (file.status.progress === newProgress) {\n      return\n    }\n\n    // Update file.progress\n    this.updateFile(\n      fileId,\n      file.setStatus({\n        type: \"uploading\",\n        cancelToken: file.status.cancelToken,\n        progress: newProgress,\n      })\n    )\n  }\n\n  /**\n   * Clear files and errors, and reset the widget to its READY state.\n   */\n  private reset = (): void => {\n    this.setState({ files: [], imgSrc: null })\n  }\n\n  public uploadFile = (fileURLs: IFileURLs, file: File): void => {\n    // Create an UploadFileInfo for this file and add it to our state.\n    const cancelToken = axios.CancelToken.source()\n    const uploadingFileInfo = new UploadFileInfo(\n      file.name,\n      file.size,\n      this.nextLocalFileId(),\n      {\n        type: \"uploading\",\n        cancelToken,\n        progress: 1,\n      }\n    )\n    this.addFile(uploadingFileInfo)\n\n    this.props.uploadClient\n      .uploadFile(\n        this.props.element,\n        fileURLs.uploadUrl as string,\n        file,\n        e => this.onUploadProgress(e, uploadingFileInfo.id),\n        cancelToken.token\n      )\n      .then(() => this.onUploadComplete(uploadingFileInfo.id, fileURLs))\n      .catch(err => {\n        // If this was a cancel error, we don't show the user an error -\n        // the cancellation was in response to an action they took.\n        if (!axios.isCancel(err)) {\n          this.updateFile(\n            uploadingFileInfo.id,\n            uploadingFileInfo.setStatus({\n              type: \"error\",\n              errorMessage: err ? err.toString() : \"Unknown error\",\n            })\n          )\n        }\n      })\n  }\n}\n\nfunction urltoFile(url: string, filename: string): Promise<File> {\n  return fetch(url)\n    .then(res => res.arrayBuffer())\n    .then(buf => new File([buf], filename, { type: \"image/jpeg\" }))\n}\n\nexport default CameraInput\n"],"names":["Video","React.forwardRef","props","ref","attrs","React.createElement","EmotionIconBase","_extends","X","SwitchCamera","Size","getSizeStyle","size","theme","padding","spacing","twoXS","sm","fontSize","fontSizes","md","xs","StyledCameraInput","styled","position","overflow","width","objectFit","StyledBox","backgroundColor","colors","secondaryBg","borderRadius","radii","default","height","display","flexDirection","justifyContent","alignItems","StyledDescription","marginTop","textAlign","StyledImg","opacity","StyledLink","color","primary","textDecoration","StyledSpan","StyledSwitchFacingModeButton","top","lg","right","zIndex","zIndices","priority","fadedText40","mixBlendMode","StyledProgressBar","bottom","StyledCameraInputBaseButton","lightenedBg05","border","sizes","borderWidth","borderColor","white","fontWeight","fontWeights","normal","margin","none","lineHeight","lineHeights","base","userSelect","outline","boxShadow","transparentize","CameraInputButton","disabled","onClick","children","progress","data-testid","ProgressBar","value","ProgressBarSize","EXTRASMALL","overrides","Bar","style","borderTopLeftRadius","borderTopRightRadius","BarProgress","BarContainer","FacingMode","SwitchFacingModeButton","switchFacingMode","Tooltip","content","placement","Placement","TOP_RIGHT","BaseButton","kind","BaseButtonKind","MINIMAL","Icon","themeColors","root","factory","module","require$$0","this","__WEBPACK_EXTERNAL_MODULE_react__","modules","installedModules","__webpack_require__","moduleId","exports","name","getter","mode","ns","key","object","property","__webpack_exports__","react__WEBPACK_IMPORTED_MODULE_0__","__extends","extendStatics","d","b","p","__","__assign","t","s","i","n","__rest","e","constraints","getUserMedia","resolve","reject","hasGetUserMedia","Webcam","_super","_this","_a","state","nextProps","audioConstraintsChanged","videoConstraintsChanged","minScreenshotWidthChanged","minScreenshotHeightChanged","stream","track","screenshotDimensions","canvas","canvasWidth","canvasHeight","aspectRatio","_b","ctx","sourceSelected","audioConstraints","videoConstraints","myRequestUserMediaId","optionalSource_1","id","constraintToSourceId_1","constraint","deviceId","sources","audioSource","videoSource","source","audioSourceId","videoSourceId","err","audio","mirrored","rest","videoStyle","childrenProps","WebcamPermission","AskForCameraPermission","gray60","href","CAMERA_PERMISSION_URL","rel","target","WebcamComponent","handleCapture","clearPhotoInProgress","setClearPhotoInProgress","facingMode","setFacingMode","testOverride","webcamPermission","setWebcamPermissionState","useState","videoRef","useRef","debouncedWidth","setDebouncedWidth","memoizedSetDebouncedCallback","useCallback","debounce","useEffect","capture","current","imageSrc","getScreenshot","useTheme","isMobile","_jsx","hidden","screenshotFormat","screenshotQuality","onUserMediaError","onUserMedia","ideal","MIN_SHUTTER_EFFECT_TIME_MS","CameraInput","React","PureComponent","formClearHelper","FormClearHelper","getProgress","files","length","status","type","undefined","setState","prevState","USER","ENVIRONMENT","imgSrc","Promise","shutter","minShutterEffectPassed","delay","setTimeout","urltoFile","Date","toISOString","replace","then","file","uploadClient","fetchFileURLs","fileURLsArray","fileUrls","uploadFile","_","catch","logError","removeCapture","forEach","deleteFile","componentDidUpdate","newWidgetValue","createWidgetValue","element","widgetMgr","fragmentId","prevWidgetValue","getFileUploaderStateValue","isEqual","setFileUploaderStateValue","fromUi","isNullOrUndefined","fileId","getFile","cancelToken","cancel","deleteUrl","removeFile","idToRemove","filter","find","curFileId","newFile","curState","map","localFileId","curFile","updateFile","setStatus","event","newProgress","Math","round","loaded","total","fileURLs","axios","CancelToken","uploadingFileInfo","UploadFileInfo","nextLocalFileId","addFile","uploadUrl","onUploadProgress","token","onUploadComplete","isCancel","errorMessage","toString","initialValue","emptyState","widgetValue","uploadedFileInfo","f","RESTORED_FROM_WIDGET_STRING","componentWillUnmount","disconnect","isFileUpdating","some","componentDidMount","UploadedFileInfoProto","FileUploaderStateProto","render","manageFormClearListener","formId","onFormCleared","className","WidgetLabel","label","labelVisibility","labelVisibilityProtoValueToEnum","help","StyledWidgetLabelHelp","TooltipIcon","_jsxs","_Fragment","src","alt","localFileIdCounter","url","filename","fetch","res","arrayBuffer","buf","File"],"mappings":"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","x_google_ignoreList":[0,1,2,6]}